{# templates/album_detail.html #}
{% extends "base_library.html" %}

{% block summary_header %}
<h2>
  <a href="{{ url_for('artists.artist_detail', artist_name=artist_name) }}">
    {{ artist_name }}</a> â€” {{ album_name }}</h2>
{% endblock %}

{% block main_content %}

<div style="display:flex; gap:16px; align-items:flex-start;">
  <div style="width:220px;">
    {% if cover_url %}
      <img src="{{ cover_url }}" alt="Album art" style="width:220px; height:220px; object-fit:cover; border-radius:10px;">
    {% else %}
      <div style="width:220px; height:220px; border-radius:10px; background:#eee; display:flex; align-items:center; justify-content:center;">
        no cover
      </div>
    {% endif %}
  </div>

  <div>
    {% if start and end %}
      <p><strong>Plays ({{ start }} to {{ end }}):</strong> {{ total_plays }}</p>
      <p style="color:#666;"><small>All-time plays: {{ all_time_total }}</small></p>
    {% else %}
      <p><strong>Total plays (All time):</strong> {{ total_plays }}</p>
    {% endif %}
    <p><strong>Tracks:</strong> {{ tracks|length }}</p>
    <p><strong>Release date:</strong> {{ release_year }}</p>
  </div>
</div>

<h2>Tracklist</h2>
{% if start and end %}
  <p style="color:#666;"><small>Showing plays from {{ start }} to {{ end }}</small></p>
{% endif %}
{% if tracks %}
<table class="table">
  <thead>
    <tr>
      <th>#</th>
      <th>Track</th>
      <th>Plays</th>
    </tr>
  </thead>
  <tbody>
    {% for row in tracks %}
      <tr>
        <td>{{ row["track_number"] }}</td>
        <td><a href="{{ url_for('tracks.track_detail', artist_name=artist_name, track_name=row['track_name']) }}">
          {{ row["track_name"] }}</a>
        </td>
        <td>{{ row["plays"] }}</td>
      </tr>
    {% endfor %}
  </tbody>
</table>
{% else %}
<p><em>Tracklist not available for this album. Last.fm may not have information about this release.</em></p>
{% endif %}
{% endblock %}