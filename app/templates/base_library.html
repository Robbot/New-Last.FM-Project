<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}My Listening stats{% endblock %}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='main.css', v=1) }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/data_range_bars.css') }}">
    {% block head %}{% endblock %}
</head>
<body>
<!-- base_library.html -->
<h1>Library</h1>

<ul class="nav nav-tabs">
  <li class="nav-item">
    <a class="nav-link {% if active_tab == 'scrobbles' %}active{% endif %}"
       href="{{ url_for('scrobbles.library_scrobbles') }}" data-nav-tab>Scrobbles</a>
  </li>
  <li class="nav-item">
    <a class="nav-link {% if active_tab == 'artists' %}active{% endif %}"
       href="{{ url_for('artists.library_artists') }}" data-nav-tab>Artists</a>
  </li>
  <li class="nav-item">
    <a class="nav-link {% if active_tab == 'albums' %}active{% endif %}"
       href="{{ url_for('albums.library_albums') }}" data-nav-tab>Albums</a>
  </li>
  <li class="nav-item">
    <a class="nav-link {% if active_tab == 'tracks' %}active{% endif %}"
       href="{{ url_for('tracks.library_tracks') }}" data-nav-tab>Tracks</a>
  </li>
</ul>

<script>
// Preserve date range parameters when clicking navigation tabs
document.addEventListener('DOMContentLoaded', function() {
  const currentUrl = new URL(window.location.href);
  const from = currentUrl.searchParams.get('from');
  const to = currentUrl.searchParams.get('to');
  const rangetype = currentUrl.searchParams.get('rangetype');

  // Only modify tabs if date parameters exist
  if (from || to || rangetype) {
    document.querySelectorAll('[data-nav-tab]').forEach(function(link) {
      const linkUrl = new URL(link.href);
      if (from) linkUrl.searchParams.set('from', from);
      if (to) linkUrl.searchParams.set('to', to);
      if (rangetype) linkUrl.searchParams.set('rangetype', rangetype);
      link.href = linkUrl.toString();
    });
  }
});
</script>

<div class="mt-3">
  {% block summary_header %}{% endblock %}
</div>

<div class="drb">
  <!-- Main content area -->
  <div class="drb__left">
    {% block main_content %}{% endblock %}
  </div>

  <!-- Date range sidebar -->
  {% set artist = artist_name | default('') %}
  {% set album = album_name | default('') %}
  {% set track = track_name | default('') %}
  {% include '_daterange.html' %}
</div>

<script src="{{ url_for('static', filename='js/date_range_bars.js', v=20260110) }}"></script>
</body>
</html>